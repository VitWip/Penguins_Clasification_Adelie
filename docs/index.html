// Function to try a different path for loading data
function tryPath(basePath, dataType) {
  const paths = {
    latest: `${basePath}`,
    statistics: `${basePath.replace('latest_prediction.json', 'statistics.json')}`,
    history: `${basePath.replace('latest_prediction.json', 'prediction.json')}` // Changed from prediction_history.json to prediction.json
  };
  
  // Clear previous errors
  document.querySelectorAll('.error').forEach(el => el.remove());
  
  // Show loading indicators
  document.getElementById('latest-penguin').innerHTML = `
    <div class="loading">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-2">Trying new path: ${paths.latest}</p>
    </div>
  `;
  
  document.getElementById('statistics-container').innerHTML = `
    <div class="loading">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-2">Trying new path: ${paths.statistics}</p>
    </div>
  `;
  
  document.getElementById('predictions-container').innerHTML = `
    <div class="loading">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-2">Trying new path: ${paths.history}</p>
    </div>
  `;
  
  // Load data with new paths
  loadDashboardData(paths.latest, paths.statistics, paths.history);
}

// Function to load all dashboard data
function loadDashboardData(latestPath = 'assets/latest_prediction.json', // Removed leading slash
                           statsPath = 'assets/statistics.json', // Removed leading slash
                           historyPath = 'assets/prediction.json') { // Changed from prediction_history.json to prediction.json
  // Fetch latest prediction
  fetch(latestPath)
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      updateLatestPenguin(data);
    })
    .catch(error => {
      document.getElementById('latest-penguin').innerHTML = `
        <div class="error">
          Failed to load latest penguin data: ${error.message}
          <br>
          <small>Attempted path: ${latestPath}</small>
        </div>
      `;
      console.error('Error fetching latest penguin data:', error);
    });
  
  // Fetch statistics
  fetch(statsPath)
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      updateStatistics(data);
    })
    .catch(error => {
      document.getElementById('statistics-container').innerHTML = `
        <div class="error">
          Failed to load statistics: ${error.message}
          <br>
          <small>Attempted path: ${statsPath}</small>
        </div>
      `;
      console.error('Error fetching statistics:', error);
    });
  
  // Fetch prediction history
  fetch(historyPath)
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      updatePredictions(data);
    })
    .catch(error => {
      document.getElementById('predictions-container').innerHTML = `
        <div class="error">
          Failed to load prediction history: ${error.message}
          <br>
          <small>Attempted path: ${historyPath}</small>
        </div>
      `;
      console.error('Error fetching prediction history:', error);
    });
}