---
layout: default
title: Latest Penguin Classification
---

<div class="container">
  <h1>Latest Classified Penguin</h1>
  
  <div class="penguin-card" id="latest-penguin">
    <div class="loading">Loading latest penguin data...</div>
  </div>

  <style>
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }

    .penguin-card {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      padding: 20px;
      margin-top: 20px;
    }

    .penguin-details {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .detail-item {
      background: #f5f5f5;
      padding: 15px;
      border-radius: 6px;
    }

    .detail-label {
      font-weight: bold;
      color: #666;
      margin-bottom: 5px;
    }

    .detail-value {
      font-size: 1.2em;
      color: #333;
    }

    .species-prediction {
      margin-top: 20px;
      padding: 15px;
      background: #e3f2fd;
      border-radius: 6px;
      text-align: center;
    }

    .confidence-bar {
      background: #ddd;
      height: 20px;
      border-radius: 10px;
      margin-top: 10px;
      overflow: hidden;
    }

    .confidence-level {
      background: #4caf50;
      height: 100%;
      transition: width 0.3s ease;
    }

    .timestamp {
      text-align: right;
      color: #666;
      font-size: 0.9em;
      margin-top: 10px;
    }

    .loading {
      text-align: center;
      padding: 20px;
      color: #666;
    }
  </style>

  <script>
    function formatDateTime(dateStr) {
      const date = new Date(dateStr);
      return date.toLocaleString();
    }

    function updatePenguinCard(data) {
      const card = document.getElementById('latest-penguin');
      if (!data) {
        card.innerHTML = '<div class="error" style="color: #d32f2f; padding: 15px; background: #ffebee; border-radius: 6px;">No penguin data available. The server returned an empty response.</div>';
        return;
      }

      try {
        card.innerHTML = `
          <div class="species-prediction">
            <h2>Predicted Species: ${data.species}</h2>
            <div class="confidence-bar">
              <div class="confidence-level" style="width: ${data.confidence * 100}%"></div>
            </div>
            <p>Confidence: ${(data.confidence * 100).toFixed(1)}%</p>
          </div>

          <div class="penguin-details">
            <div class="detail-item">
              <div class="detail-label">Bill Length</div>
              <div class="detail-value">${data.bill_length_mm} mm</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Bill Depth</div>
              <div class="detail-value">${data.bill_depth_mm} mm</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Flipper Length</div>
              <div class="detail-value">${data.flipper_length_mm} mm</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Body Mass</div>
              <div class="detail-value">${data.body_mass_g} g</div>
            </div>
          </div>

          <div class="timestamp">
            Classified on: ${formatDateTime(data.datetime)}
          </div>
        `;
      } catch (error) {
        card.innerHTML = `<div class="error" style="color: #d32f2f; padding: 15px; background: #ffebee; border-radius: 6px;">
          Error processing penguin data: ${error.message}. Please try refreshing the page.
        </div>`;
        console.error('Error processing penguin data:', error);
      }
    }

    // Fetch and display the latest penguin data
    fetch('_data/latest_prediction.json')
      .then(response => {
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
      })
      .then(data => updatePenguinCard(data))
      .catch(error => {
        console.error('Error fetching penguin data:', error);
        const errorMessage = error.name === 'SyntaxError' ?
          'Invalid data received from server. Please try again later.' :
          error.message.includes('HTTP error') ?
          'Could not connect to the server. Please check your internet connection.' :
          'An unexpected error occurred while loading penguin data.';

        document.getElementById('latest-penguin').innerHTML = 
          `<div class="error" style="color: #d32f2f; padding: 15px; background: #ffebee; border-radius: 6px;">${errorMessage}</div>`;
      });
  </script>
</div>